<!DOCTYPE html>
<html>
<head>
	<title></title>

    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
    <!-- bootstrap 3.3.7 -->
    <script src="{{ url_for('static', filename='bootstrap3/js/bootstrap.min.js') }}"></script>
    <link rel="stylesheet" type="text/css" 
        href="{{ url_for('static', filename='bootstrap3/css/bootstrap.min.css') }}">

</head>
<body>

	<select name="school" id="school">
		<option value="">Select School</option>
        <option value="1">INFSPM</option>
    </select>

	<select name="branch" id="branch" disabled="">
    </select>

	<select name="promo" id="promo" disabled="">
    </select>

	<select name="session" id="session" disabled="">
    </select>

	<select name="module" id="module" disabled="">
    </select>



    <script>

    function on_change_select_options(thisId, name, url, followingIds) {
    	console.log('on_change_select_options '+name);
	    $('#'+thisId).on('change', function(){
	    	console.log('change');
	        var ID = $(this).val();
	        console.log('ID: '+ID);
	        if(ID){
	        	console.log('ajax '+url+ID);
	            $.ajax({
	                // type: 'POST',
	                // url: url,
	                // data: 'id='+ID,
	                type: 'GET',
	                url: url+ID,
	                success:function(html){
	                	console.log('success');
	                    $('#'+followingIds[0]).html(html);
	                    $('#'+followingIds[0]).prop('disabled', false);
	                    for(i=1; i < followingIds.length; i++){
	                    	// option = '<option value="">Select '+name+' first</option>'
	                    	$('#'+followingIds[i]).html('');
	                    	$('#'+followingIds[i]).prop('disabled', 'disabled');
	                    }
	                },
				    error: function(XMLHttpRequest, textStatus, errorThrown) {
				      console.log('some error in '+name);
				    }
	            });
	        }else{
	            console.log('no id in '+name);

                for(i=0; i < followingIds.length; i++){
                	// option = '<option value="">Select '+name+' first</option>'
                	$('#'+followingIds[i]).html('')
                	$('#'+followingIds[i]).prop('disabled', 'disabled');
	            }
	        }
	    });

    }


	$(document).ready(function(){

		on_change_select_options(
			'school', 'School', '/select-options-branches-by-school/', 
			['branch','promo','session','module']);

		on_change_select_options(
			'branch', 'Branch', '/select-options-promos-by-branch/', 
			['promo','session','module']);

		on_change_select_options(
			'promo', 'Promo', '/select-options-session-by-promo/', 
			['session','module']);

		on_change_select_options(
			'session', 'Session', '/select-options-module-by-session/', 
			['module']);

	});
	</script>

</body>
</html>